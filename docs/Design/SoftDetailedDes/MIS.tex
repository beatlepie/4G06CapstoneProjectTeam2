\documentclass[12pt, titlepage]{article}

\usepackage{amsmath, mathtools}

\usepackage[round]{natbib}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{colortbl}
\usepackage{xr}
\usepackage{hyperref}
\usepackage{longtable}
\usepackage{xfrac}
\usepackage{tabularx}
\usepackage{float}
\usepackage{siunitx}
\usepackage{booktabs}
\usepackage{multirow}
\usepackage[section]{placeins}
\usepackage{caption}
\usepackage{fullpage}

\hypersetup{
bookmarks=true,     % show bookmarks bar?
colorlinks=true,       % false: boxed links; true: colored links
linkcolor=red,          % color of internal links (change box color with linkbordercolor)
citecolor=blue,      % color of links to bibliography
filecolor=magenta,  % color of file links
urlcolor=cyan          % color of external links
}

\usepackage{array}

\externaldocument{../../SRS/SRS}

\input{../../Comments}
\input{../../Common}

\begin{document}

\title{Module Interface Specification for \progname{}}

\author{\authname}

\date{\today}

\maketitle

\pagenumbering{roman}

\section{Revision History}

\begin{tabularx}{\textwidth}{p{3cm}p{2cm}X}
\toprule {\bf Date} & {\bf Version} & {\bf Notes}\\
\midrule
Jan 15 & 1.0 & Add introduction and module decomposition\\
Jan 17 & 1.0 & Revision 0\\
\bottomrule
\end{tabularx}

~\newpage

\section{Symbols, Abbreviations and Acronyms}

See SRS Documentation at \href{https://github.com/beatlepie/4G06CapstoneProjectTeam2/blob/main/docs/SRS-Volere/SRS.pdf}{SRS}
\subsection{Abbreviations and Acronyms}

\renewcommand{\arraystretch}{1.2}
\begin{tabular}{l l} 
  \toprule		
  \textbf{symbol} & \textbf{description}\\
  \midrule 
  MIS & Module Interface Specification \\
  MG & Module Guide \\
  SRS & Software Requirement Specification\\
  AR & Augmented Reality\\
  \bottomrule
\end{tabular}\\

\newpage

\tableofcontents

\newpage

\pagenumbering{arabic}

\section{Introduction}

The following document details the Module Interface Specifications for CampusConnections. CampusConnections is a social media application with impressive AR camera and real time location map features that allows McMaster University students and visitors have an immersive user experience and expand their social networking. This application allows users to make new friends online and also encourage users to strengthen the friendship by in-person meet-ups with a on-campus location-sharing feature. It also provides heat maps of events and users, which allows students to join the most popular activities on campus. Besides, the application maintainers will share up-to-date events and lectures information for the community. The MIS will detail specifications for the project described above.

Complementary documents include the System Requirement Specifications (SRS)
and Module Guide. (MG)  The full documentation and implementation can be
found at \url{https://github.com/beatlepie/4G06CapstoneProjectTeam2/blob/main/docs/SRS-Volere/SRS.pdf} and \url{https://github.com/beatlepie/4G06CapstoneProjectTeam2/blob/main/docs/Design/SoftArchitecture/MG.pdf}

\section{Notation}
The structure of the MIS for modules comes from \citet{HoffmanAndStrooper1995},
with the addition that template modules have been adapted from
\cite{GhezziEtAl2003}.  The mathematical notation comes from Chapter 3 of
\citet{HoffmanAndStrooper1995}.  For instance, the symbol := is used for a
multiple assignment statement and conditional rules follow the form $(c_1
\Rightarrow r_1 | c_2 \Rightarrow r_2 | ... | c_n \Rightarrow r_n )$.

The following table summarizes the primitive data types used by \progname. 

\begin{center}
\renewcommand{\arraystretch}{1.2}
\noindent 
\begin{tabular}{l l p{7.5cm}} 
\toprule 
\textbf{Data Type} & \textbf{Notation} & \textbf{Description}\\ 
\midrule
character & char & a single symbol or digit\\
integer & $\mathbb{Z}$ & a number without a fractional component in (-$\infty$, $\infty$) \\
natural number & $\mathbb{N}$ & a number without a fractional component in [1, $\infty$) \\
real & $\mathbb{R}$ & any number in (-$\infty$, $\infty$)\\
boolean & $\mathbb{B}$ & True or False\\
sequence of T & $<$T$>$ & a list of object with type T\\
asynchronous step T & Task$<$T$>$ & an asynchronous result of T\\
\bottomrule
\end{tabular} 
\end{center}

\noindent
The specification of \progname \ uses some derived data types: sequences, strings, and
tuples. Sequences are lists filled with elements of the same data type. Strings
are sequences of characters. Tuples contain a list of values, potentially of
different types. In addition, \progname \ uses functions, which
are defined by the data types of their inputs and outputs. Local functions are
described by giving their type signature followed by their specification.

\section{Module Decomposition}

The following table is taken directly from the Module Guide document for this project.

\begin{table}[h!]
\centering
\begin{tabular}{p{0.3\textwidth} p{0.6\textwidth}}
\toprule
\textbf{Level 1} & \textbf{Level 2}\\
\midrule

{Hardware-Hiding} & ~ \\
\midrule

\multirow{7}{0.3\textwidth}{Behaviour-Hiding}
& AR Interface Module\\
& Map Interface Module\\
& User Module\\
& Lecture Module\\
& Event Module\\
& Account Module\\
& Permission Module\\
& User Profile Module\\
& User Login Module\\
& Friend Manager Module\\ 
& Friend Request Module\\
& Friend Chat Module\\
& Lecture Detail View Module\\
& Event Detail View Module\\
& Lecture List Manager Module\\
& Event List Manager Module\\
\midrule

\multirow{3}{0.3\textwidth}{Software Decision}
& Database Module\\
& Server Module\\
& Authentication Module\\
& AR Camera Module\\
& Mapbox Module\\
& Activity Detail View Module\\
& Pagination and Filter Module\\
\bottomrule

\end{tabular}
\caption{Module Hierarchy}
\label{TblMH}
\end{table}

\newpage

\section{MIS of Lecture Module} \label{mLec}

\subsection{Module}

Lecture

\subsection{Uses}

None

\subsection{Syntax}

\subsubsection{Exported Constants}
None

\subsubsection{Exported Access Programs}
\begin{center}
\begin{tabular}{p{4cm} p{2cm} p{4cm} p{4cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
Lecture & String, String, String, String, String & Lecture & -\\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}

\begin{itemize}
\item Code: Lecture code
\item Name: Lecture name
\item instructor: Lecture instructor
\item time: Lecture time
\item location: Lecture location
\end{itemize}

\subsubsection{Environment Variables}

None

\subsubsection{Assumptions}

Strings passed as input are of valid format.

\subsubsection{Access Routine Semantics}

\noindent Lecture(code, name, instructor, time, location):
\begin{itemize}
\item transition: Initializes an instance of the 'Lecture' class with the given parameters.
\item output: Instance of 'Lecture'.
\item exception: none
\end{itemize}

\subsubsection{Local Functions}

None

\newpage

\section{MIS of Event Module} \label{mEvent}

\subsection{Module}

Event

\subsection{Uses}

None

\subsection{Syntax}

\subsubsection{Exported Constants}
None

\subsubsection{Exported Access Programs}
\begin{center}
\begin{tabular}{p{4cm} p{2cm} p{4cm} p{4cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
Event & String, String, String, String & Event & -\\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}

\begin{itemize}
\item Name: Event name
\item Date: Event date
\item Location: Event location
\item Organizer: Event organizer
\end{itemize}

\subsubsection{Environment Variables}

None

\subsubsection{Assumptions}

Parameters to the constructor are of the correct format.

\subsubsection{Access Routine Semantics}

\noindent Event(name, date, location, organizer):
\begin{itemize}
\item transition: Initializes an instance of the 'Event' class with the given parameters.
\item output: Instance of 'Event'.
\item exception: none
\end{itemize}

\subsubsection{Local Functions}

None

\newpage

\section{MIS of Account Module} \label{mAccount}

\subsection{Module}

Account

\subsection{Uses}

Database Module, User Module, Authentication Module

\subsection{Syntax}

\subsubsection{Exported Constants}
None

\subsubsection{Exported Access Programs}
\begin{center}
\begin{tabular}{p{4cm} p{2cm} p{4cm} p{4cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
UpdateNickName & String & -\\
UpdateProgram & String & -\\
UpdateLevel & $\mathbb{N}$ & -\\
AddFriend & User & -\\
DeleteFriend & User & IndexOutofBound Exception\\
AddRequest & User & -\\
DeleteRequest & User & IndexOutofBound Exception\\
PinLecture & Lecture & - \\
UnPinLecture & Lecture & IndexOutofBound Exception\\
PinEvent & Event & - \\
UnPinEvent & Event & IndexOutofBound Exception\\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}

\begin{itemize}
\item User: User
User of the account
\end{itemize}

\subsubsection{Environment Variables}

None

\subsubsection{Assumptions}

All the sate variables of User is accessible directly so there is no getters in the module.

\subsubsection{Access Routine Semantics}

\noindent UpdateNickName(newName):
\begin{itemize}
\item transition: $User.nickName := newName$
\item output: none
\item exception: none
\end{itemize}

\noindent UpdateProgram(newProgram):
\begin{itemize}
\item transition: $User.program := newProgram$
\item output: none
\item exception: none
\end{itemize}

\noindent UpdateLevel(newLevel):
\begin{itemize}
\item transition: $User.level := newLevel$
\item output: none
\item exception: none
\end{itemize}

\noindent AddFriend(newFriend):
\begin{itemize}
\item transition: $User.friends := User.friends + \{newFriend\}$ 
\item output: none
\item exception: none
\end{itemize}

\noindent DeleteFriend(targetFriend):
\begin{itemize}
\item transition: $User.friends := User.friends - \{targetFriend\}$ 
\item output: none
\item exception: $exc := targetFriend \notin User.friends \Rightarrow IndexOutofBound Exception$
\end{itemize}

\noindent AddRequest(newFriend):
\begin{itemize}
\item transition: $User.friendRequests := User.friendRequests + \{newFriend\}$ 
\item output: none
\item exception: none
\end{itemize}

\noindent DeleteRequest(targetFriend):
\begin{itemize}
\item transition: $User.friendRequests := User.friendRequests - \{targetFriend\}$ 
\item output: none
\item exception: $exc := targetFriend \notin User.friendRequests \Rightarrow IndexOutofBound Exception$
\end{itemize}

\noindent PinLecture(newLec):
\begin{itemize}
\item transition: $User.lectures := User.lectures + \{newLec\}$ 
\item output: none
\item exception: none
\end{itemize}

\noindent UnpinLecture(targetLec):
\begin{itemize}
\item transition: $User.friendRequests := User.lectures - \{targetLec\}$ 
\item output: none
\item exception: $exc := targetLec \notin User.lectures \Rightarrow IndexOutofBound Exception$
\end{itemize}

\noindent PinEvent(newEvent):
\begin{itemize}
\item transition: $User.events := User.lectures + \{newEvent\}$ 
\item output: none
\item exception: none
\end{itemize}

\noindent UnpinLecture(targetEvent):
\begin{itemize}
\item transition: $User.friendRequests := User.events - \{targetEvent\}$ 
\item output: none
\item exception: $exc := targetEvent \notin User.events \Rightarrow IndexOutofBound Exception$
\end{itemize}

\subsubsection{Local Functions}

None

\newpage

\section{MIS of Friend Manager Module} \label{mFM}

\subsection{Module}

FriendManager

\subsection{Uses}

Account Module, Chat Module, Unity Transform Type

\subsection{Syntax}

\subsubsection{Exported Constants}
None

\subsubsection{Exported Access Programs}
\begin{center}
\begin{tabular}{p{4cm} p{2cm} p{4cm} p{4cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
DisplayFriendList & - & $<$Tranform$>$ & - \\
onClickDeleteFriend & User & - & IndexOutofBound Exception\\
onClickViewFriend & User & - & IndexOutofBound Exception\\
onClickMessageFriend & User & 2D seq of pixels & IndexOutofBound Exception\\
onClickSendRequest & User & $\mathbb{B}$ & -\\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}

None

\subsubsection{Environment Variables}

None

\subsubsection{Assumptions}

Assume the singleton Account is accessible from this module.

\subsubsection{Access Routine Semantics}

\noindent DisplayFriendList():
\begin{itemize}
\item transition: none
\item output: $out := friendContainer\ where\ (\forall x : \mathbb{Z} | 0 \leq x \leq Account.friends.length:\\ friendsContainer[i].position, friendsContainer[i].content =\\ (0, i*HEIGHT), Account.friends[i])$,
\item exception: none
\end{itemize}

\noindent onClickDeleteFriend(targetUser):
\begin{itemize}
\item transition: Account.DeleteFriend(targetUser)
\item output: none
\item exception: $exc := targetUser.email \notin Account.User.friends \Rightarrow IndexOutofBound Exception$
\end{itemize}

\noindent onClickViewFriend(targetUser):
\begin{itemize}
\item transition: Switch scene to user profile where User = targetUser
\item output: none
\item exception: $exc := targetUser.email \notin Account.User.friends \Rightarrow IndexOutofBound Exception$
\end{itemize}

\noindent onClickMessageFriend(targetUser):
\begin{itemize}
\item transition: Call Chat Module to establish a connection
\item output: UI of friend chat between Account.User and targetUser
\item exception: $exc := targetUser.email \notin Account.User.friends \Rightarrow IndexOutofBound Exception$
\end{itemize}

\noindent onClickSendRequest(targetUser):
\begin{itemize}
\item transition: targetUser.AddRequest(Account1.User.email) if the current user has not send a request yet
\item output: $Account1.User.email \notin targetUser.friendRequest$
\item exception: none
\end{itemize}

\subsubsection{Local Functions}

None

\subsubsection{Local Constants}
HEIGHT = 300 px

\newpage

\section{MIS of Friend Request Module} \label{mFR}

\subsection{Module}

FriendRequest

\subsection{Uses}

Account Module, Unity Transform Type

\subsection{Syntax}

\subsubsection{Exported Constants}
None

\subsubsection{Exported Access Programs}
\begin{center}
\begin{tabular}{p{4cm} p{2cm} p{4cm} p{4cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
DisplayRequestList & - & $<$Transform$>$ & -\\
onClickAcceptRequest & User & - & IllegalArgument Exception \\
onClickIgnoreRequest & User & - & IllegalArgument Exception\\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}

None

\subsubsection{Environment Variables}

None

\subsubsection{Assumptions}

Assume the singleton Account is accessible from this module.

\subsubsection{Access Routine Semantics}
\noindent DisplayRequestList():
\begin{itemize}
\item transition: none
\item output: $out := requestContainer\ where\ (\forall x : \mathbb{Z} | 0 \leq x \leq Account.friendRequests.length:\\ requestContainer[i].position, requestContainer[i].content =\\(0, i*HEIGHT), Account.friendRequests[i])$,
\item exception: none
\end{itemize}

\noindent onClickAcceptRequest(targetUser):
\begin{itemize}
\item transition: targetUser.friends := targetUser.friends + {Account.User.email}\\Account.User.AddFriend(targetUser)\\$Account.User.DeleteRequest(targetUser)$
\item output: none
\item exception: $exc := targetUser \notin Account.User.friendRequests \Rightarrow\\ IllegalArgument Exception$
\end{itemize}

\noindent onClickIgnoreRequest(targetUser):
\begin{itemize}
\item transition: $Account.User.DeleteRequest(targetUser)$
\item output: none
\item exception: $exc := targetUser \notin Account.User.friendRequests \Rightarrow\\ IllegalArgument Exception$
\end{itemize}

\subsubsection{Local Functions}

\noindent UpdateBadge(): String\\
It returns the content of friend request badge given the request number
\begin{itemize}
\item transition: none
\item output: $out := requestNum = 0 \Rightarrow empty string \\ 0 < requestNum < 100 \Rightarrow requestNum\\ 100 \leq requestNum \Rightarrow 99+$
\item exception: none
\end{itemize}

\subsubsection{Local Constants}
HEIGHT = 150 px

\newpage

\section{MIS of Activity Detail View Module} \label{mADV}

\subsection{Module}

ActivityDetailView

\subsection{Uses}

Database Module, Permission Module

\subsection{Syntax}

\subsubsection{Exported Constants}

None

\subsubsection{Exported Access Programs}
\begin{center}
\begin{tabular}{p{4cm} p{2cm} p{4cm} p{4cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
ViewActivities & - & - & - \\
AddActivity & Activity & - & InvalidPermission Exception \\
EditActivity & Activity, Activity & - & IndexOutofBound Exception, InvalidPermission Exception \\
DeleteActivity & Activity & - & IndexOutofBound Exception, InvalidPermission Exception \\
PinActivity & Activity & - & - \\
UnpinActivity & Activity & - & IndexOutofBound Exception \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}

\begin{itemize}
  \item activities: set of Activity
  \item pinnedActivities: set of Activity
\end{itemize}

\subsubsection{Environment Variables}

None

\subsubsection{Assumptions}

Activity is a generic class with $<$T$>$ and it can be instantiated with type Lecture and Event.\\
The singleton module Permission is accessible from this module.

\subsubsection{Access Routine Semantics}

\noindent ViewActivities():
\begin{itemize}
\item transition: Display activities
\item output: none
\item exception: none
\end{itemize}

\noindent AddActivity(newActivity):
\begin{itemize}
\item transition: $activities := activities + \{newActivity\}$
\item output: none
\item exception: $exc := \neg Permission.isAdmin \Rightarrow InvalidPermission Exception$
\end{itemize}

\noindent EditActivity(targetActivity, editedActivity):
\begin{itemize}
\item transition: $activities := activities - \{targetActivity\} + \{editedActivity\}$
\item output: none
\item exception: $exc := targetActivity \notin activities \Rightarrow IndexOutofBound Exception,\\ 
                  exc := \neg Permission.isAdmin \Rightarrow InvalidPermission Exception$
\end{itemize}

\noindent DeleteActivity(targetActivity):
\begin{itemize}
\item transition: $activities := activities - \{targetActivity\}$
\item output: none
\item exception: $exc := targetActivity \notin activities \Rightarrow IndexOutofBound Exception,\\
                  exc := \neg Permission.isAdmin \Rightarrow InvalidPermission Exception$
\end{itemize}

\noindent PinActivity(newActivity):
\begin{itemize}
\item transition: $pinnedActivities := pinnedActivities + \{newActivity\}$
\item output: none
\item exception: none
\end{itemize}

\noindent UnpinActivity(targetActivity):
\begin{itemize}
\item transition: $pinnedActivities := pinnedActivities - \{targetActivity\}$
\item output: none
\item exception: $exc := targetActivity \notin pinnedActivities \Rightarrow IndexOutofBound Exception$
\end{itemize}

\subsubsection{Local Functions}

None

\subsubsection{Local Constants}

None

\newpage

\section{MIS of Lecture Detail View Module} \label{mLDV}

\subsection{Module}

LectureDetailView\\
Inherit Activity Detail View Module (Activity Detail View $<$Lecture$>$)
\subsection{Uses}

Activity Detail View Module, Lecture Module

\subsection{Syntax}

\subsubsection{Exported Constants}

None

\subsubsection{Exported Access Programs}
\begin{center}
\begin{tabular}{p{4cm} p{2cm} p{4cm} p{4cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
ViewActivities & - & - & - \\
AddActivity & Lecture & - & InvalidPermission Exception \\
EditActivity & Lecture, Lecture & - & IndexOutofBound Exception, InvalidPermission Exception \\
DeleteActivity & Lecture & - & IndexOutofBound Exception, InvalidPermission Exception \\
PinActivity & Lecture & - & - \\
UnpinActivity & Lecture & - & IndexOutofBound Exception \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}

\begin{itemize}
  \item activities: set of Lecture
  \item pinnedActivities: set of Lecture
\end{itemize}

\subsubsection{Environment Variables}

None

\subsubsection{Assumptions}

The singleton module Permission is accessible from this module.

\subsubsection{Access Routine Semantics}

\noindent ViewActivities():
\begin{itemize}
\item transition: Display lectures
\item output: none
\item exception: none
\end{itemize}

\noindent AddActivity(newActivity):
\begin{itemize}
\item transition: $activities := activities + \{newActivity\}$
\item output: none
\item exception: $exc := \neg Permission.isAdmin \Rightarrow InvalidPermission Exception$
\end{itemize}

\noindent EditActivity(targetActivity, editedActivity):
\begin{itemize}
\item transition: $activities := activities - \{targetActivity\} + \{editedActivity\}$
\item output: none
\item exception: $exc := targetActivity \notin activities \Rightarrow IndexOutofBound Exception,\\ 
                  exc := \neg Permission.isAdmin \Rightarrow InvalidPermission Exception$
\end{itemize}

\noindent DeleteActivity(targetActivity):
\begin{itemize}
\item transition: $activities := activities - \{targetActivity\}$
\item output: none
\item exception: $exc := targetActivity \notin activities \Rightarrow IndexOutofBound Exception,\\
                  exc := \neg Permission.isAdmin \Rightarrow InvalidPermission Exception$
\end{itemize}

\noindent PinActivity(newActivity):
\begin{itemize}
\item transition: $pinnedActivities := pinnedActivities + \{newActivity\}$
\item output: none
\item exception: none
\end{itemize}

\noindent UnpinActivity(targetActivity):
\begin{itemize}
\item transition: $pinnedActivities := pinnedActivities - \{targetActivity\}$
\item output: none
\item exception: $exc := targetActivity \notin pinnedActivities \Rightarrow IndexOutofBound Exception$
\end{itemize}

\subsubsection{Local Functions}

None

\subsubsection{Local Constants}

None

\newpage

\section{MIS of Event Detail View Module} \label{mEDV}

\subsection{Module}

EventDetailView\\
Inherit Activity Detail View Module (Activity Detail View $<$Event$>$)
\subsection{Uses}

Activity Detail View Module, Event Module

\subsection{Syntax}

\subsubsection{Exported Constants}

None

\subsubsection{Exported Access Programs}
\begin{center}
\begin{tabular}{p{4cm} p{2cm} p{4cm} p{4cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
ViewActivities & - & - & - \\
AddActivity & Event & - & InvalidPermission Exception \\
EditActivity & Event, Event & - & IndexOutofBound Exception, InvalidPermission Exception \\
DeleteActivity & Event & - & IndexOutofBound Exception, InvalidPermission Exception \\
PinActivity & Event & - & - \\
UnpinActivity & Event & - & IndexOutofBound Exception \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}

\begin{itemize}
  \item activities: set of Event
  \item pinnedActivities: set of Event
\end{itemize}

\subsubsection{Environment Variables}

None

\subsubsection{Assumptions}

The singleton module Permission is accessible from this module.

\subsubsection{Access Routine Semantics}

\noindent ViewActivities():
\begin{itemize}
\item transition: Display events
\item output: none
\item exception: none
\end{itemize}

\noindent AddActivity(newActivity):
\begin{itemize}
\item transition: $activities := activities + \{newActivity\}$
\item output: none
\item exception: $exc := \neg Permission.isAdmin \Rightarrow InvalidPermission Exception$
\end{itemize}

\noindent EditActivity(targetActivity, editedActivity):
\begin{itemize}
\item transition: $activities := activities - \{targetActivity\} + \{editedActivity\}$
\item output: none
\item exception: $exc := targetActivity \notin activities \Rightarrow IndexOutofBound Exception,\\ 
                  exc := \neg Permission.isAdmin \Rightarrow InvalidPermission Exception$
\end{itemize}

\noindent DeleteActivity(targetActivity):
\begin{itemize}
\item transition: $activities := activities - \{targetActivity\}$
\item output: none
\item exception: $exc := targetActivity \notin activities \Rightarrow IndexOutofBound Exception,\\
                  exc := \neg Permission.isAdmin \Rightarrow InvalidPermission Exception$
\end{itemize}

\noindent PinActivity(newActivity):
\begin{itemize}
\item transition: $pinnedActivities := pinnedActivities + \{newActivity\}$
\item output: none
\item exception: none
\end{itemize}

\noindent UnpinActivity(targetActivity):
\begin{itemize}
\item transition: $pinnedActivities := pinnedActivities - \{targetActivity\}$
\item output: none
\item exception: $exc := targetActivity \notin pinnedActivities \Rightarrow IndexOutofBound Exception$
\end{itemize}

\subsubsection{Local Functions}

None

\subsubsection{Local Constants}

None

\newpage

\section{MIS of Authentication Module} \label{mFM}

\subsection{Module}

Authentication

\subsection{Uses}

User Module, Database Module, Server Module

\subsection{Syntax}

\subsubsection{Exported Constants}
None

\subsubsection{Exported Access Programs}

\subsection{Semantics}

\subsubsection{State Variables}

\begin{itemize}
\item User: FirebaseUser
\end{itemize}

\subsubsection{Environment Variables}

None

\subsubsection{Assumptions}

The user will have a unique account and only has access to that account.

\subsubsection{Access Routine Semantics}

\noindent Register():
\begin{itemize}
\item transition: $friends := GetFriendsFromDB(currentUser)$ 
\item output: none
\item exception: none
\end{itemize}

\subsubsection{Local Functions}

\noindent Login(\_email, \_password):
\begin{itemize}
\item transition: $\exists <\_email, \_password> \in FirebaseAuth \Rightarrow Login$
\item output: $User = AuthResult.CurrentUser$
\item exception: $exc:= \lnot(\exists <\_email, \_password> \in FirebaseAuth) \Rightarrow AuthFailedException$
\end{itemize}

\noindent Register():
\begin{itemize}
\item transition: $\lnot(\exists \_email \in FirebaseAuth) \rightarrow FirebaseAuth.add(User) \land FirebaseDatabase.add(User)$ 
\item output: $User \in FirebaseAuth \land User \in FirebaseDatabase$
\item exception: $\exists \_email \in FirebaseAuth \rightarrow IllegalDatabaseOperationException$
\end{itemize}

\subsubsection{Local Constants}

\begin{itemize}
  \item auth: FirebaseAuth
  \item DatabaseReference: DatabaseReference
\end{itemize}

\newpage

\section{MIS of Lecture List Manager Module} \label{mLL}

\subsection{Module}

Lecture List Manager

\subsection{Uses}

Lecture Module, Database Module

\subsection{Syntax}

\subsubsection{Exported Constants}
None

\subsubsection{Exported Access Programs}
\begin{center}
\begin{tabular}{p{4cm} p{2cm} p{4cm} p{4cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
Start & - & - & InitializationException \\
WriteNewLec & - & - & DatabaseException \\
GetLectures & Action<string> & - & DatabaseException \\
GetLectureData & - & - & CoroutineException \\
ExitDataPage & - & - & SceneLoadingException \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}

\begin{itemize}
\item databaseReference
\item lecList
\item lecCode
\item lecName
\item lecInstructor
\end{itemize}

\subsubsection{Environment Variables}

None

\subsubsection{Assumptions}

The lecture data is in the correct format and the database is accessible.

\subsubsection{Access Routine Semantics}

\noindent Start():
\begin{itemize}
\item transition: Initializes the databaseReference and calls GetLectureData.
\item output: none
\item exception: InitializationException
\end{itemize}

\noindent WriteNewLec():
\begin{itemize}
\item transition: Creates a new Lecture object with the data from lecCode, lecName, and lecInstructor, and writes it to the Firebase database.
\item output: none
\item exception: DatabaseException
\end{itemize}

\noindent GetLectures(onCallBack):
\begin{itemize}
\item transition: Retrieves the lecture data from the Firebase database.
\item output: none
\item exception: DatabaseException
\end{itemize}

\noindent GetLectureData():
\begin{itemize}
\item transition: Calls GetLectures and sets the lecture data to the retrieved data.
\item output: none
\item exception: CoroutineException
\end{itemize}

\noindent ExitDataPage():
\begin{itemize}
\item transition: Changes the scene to "MenuScene".
\item output: none
\item exception: SceneLoadingException
\end{itemize}

\subsubsection{Local Functions}

None

\newpage

\section{MIS of Event List Manager Module} \label{mEL}

\subsection{Module}

Event List Manager

\subsection{Uses}

Event Module, Database Module

\subsection{Syntax}

\subsubsection{Exported Constants}
None

\subsubsection{Exported Access Programs}
\begin{center}
\begin{tabular}{p{4cm} p{2cm} p{4cm} p{4cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
Start & - & - & - \\
Update & - & - & - \\
HandleChildAdded & object, ChildChangedEventArgs & - & DatabaseError \\
WriteNewEvent & - & - & InvalidDateFormatException, DatabaseException \\
GetEvents & Action<string> & IEnumerator & - \\
GetEventData & - & - & - \\
ExitDataPage & - & - & - \\
OnDestroy & - & - & - \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}

\begin{itemize}
\item databaseReference
\item eventList
\item scrollView
\item eventsTextRectTransform
\item errorMessage
\item originalPosition
\item eventName
\item eventDate
\item eventLocation
\item eventOrganizer
\item scrollRect
\end{itemize}

\subsubsection{Environment Variables}

\begin{itemize}
\item eventList
\item scrollView
\item eventsTextRectTransform
\item errorMessage
\item eventName
\item eventDate
\item eventLocation
\item eventOrganizer
\item scrollRect
\end{itemize}

\subsubsection{Assumptions}

The event data is in the correct format and the database is accessible.

\subsubsection{Access Routine Semantics}

\noindent Start():
\begin{itemize}
\item transition: Initializes the databaseReference, originalPosition, and subscribes to the ChildAdded event. Calls GetEventData.
\item output: none
\item exception: none
\end{itemize}

\noindent Update():
\begin{itemize}
\item transition: Updates the position of the eventsTextRectTransform based on the active state of scrollView.
\item output: none
\item exception: none
\end{itemize}

\noindent HandleChildAdded(object sender, ChildChangedEventArgs args):
\begin{itemize}
\item transition: If there is no database error, calls GetEvents to update the event list.
\item output: none
\item exception: DatabaseError
\end{itemize}

\noindent WriteNewEvent():
\begin{itemize}
\item transition: Validates the event date format, creates a new Event object, and writes it to the database.
\item output: none
\item exception: InvalidDateFormatException, DatabaseException
\end{itemize}

\noindent GetEvents(Action<string> onCallBack):
\begin{itemize}
\item transition: Retrieves event data from the database and formats it into a string.
\item output: IEnumerator
\item exception: none
\end{itemize}

\noindent GetEventData():
\begin{itemize}
\item transition: Calls GetEvents to retrieve event data and updates the eventList text and scrollRect position.
\item output: none
\item exception: none
\end{itemize}

\noindent ExitDataPage():
\begin{itemize}
\item transition: Loads the "LoginScene".
\item output: none
\item exception: none
\end{itemize}

\noindent OnDestroy():
\begin{itemize}
\item transition: Unsubscribes from the ChildAdded event.
\item output: none
\item exception: none
\end{itemize}

\subsubsection{Local Functions}

None

\newpage

\section{MIS of Database Module} \label{mDB}

\subsection{Module}

FirebaseDatabase

\noindent This module uses Firebase Realtime Database library. For details of all syntax and semantics of exported constants and access programs, see \href{https://firebase.google.com/docs/reference/unity/namespace/firebase/database}{Firebase database documentation}.
documentation
\subsection{Uses}

\subsection{Syntax}

\subsubsection{Exported Constants}
See \href{https://firebase.google.com/docs/reference/unity/namespace/firebase/database}{Firebase database documentation}.
\subsubsection{Exported Access Programs}
The following table will show some functions the application uses most frequently, for more details, see \href{https://firebase.google.com/docs/reference/unity/namespace/firebase/database}{Firebase database documentation}.
\begin{center}
\begin{tabular}{p{4cm} p{2cm} p{4cm} p{4cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
Child & String & DatabaseReference & PermissionDenied, NetworkError, ExpiredToken \\
HasChild & String & $\mathbb{B}$ & PermissionDenied, NetworkError, ExpiredToken \\
RemoveValueAsync & String & Task$<\mathbb{B}>$ & PermissionDenied,  NetworkError,  ExpiredToken \\
SetValueAsync & String , String & Task$<\mathbb{B}>$ & PermissionDenied,  NetworkError,  ExpiredToken \\
GetValueAsync & String & Task$<$DataSnapshot$>$ & PermissionDenied, NetworkError,  ExpiredToken \\
GoOffline & - & - & PermissionDenied, NetworkError,  ExpiredToken \\
GoOnline & - & - & PermissionDenied, NetworkError,  ExpiredToken \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}

None

\subsubsection{Environment Variables}

\begin{itemize}
\item DBreference: Firebase.Database.DatabaseReference\\
A reference to the root location of this database
\item User: Firebase.Auth.FirebaseUser\\
The current user that operates this database
\item PermittedUsers: set of String\\
The list of user emails that are allowed to read the database content
\item Admins: set of String\\
The list of user emails that are allowed to edit the database content
\end{itemize}


\subsubsection{Assumptions}

Assume the database connection is stable and it will not disconnect unless the user disconnect it manually.

\subsubsection{Access Routine Semantics}

\noindent Child(pathString):
\begin{itemize}
\item transition: none 
\item output: $out :=$ DatabaseReference to pathString relative to the root
\item exception: $exc := NoInternet \Rightarrow NetworkError\ | \ TokenExpired \Rightarrow ExpiredToken\ | \\ User.email \notin PermittedUsers \Rightarrow PermissionDenied$
\end{itemize}

\noindent HasChild(pathString):
\begin{itemize}
\item transition: none 
\item output: $out := DBreference.Child(pathString) = \text{null}$
\item exception: $exc := NoInternet \Rightarrow NetworkError\ | \ TokenExpired \Rightarrow ExpiredToken\ | \\ User.email \notin PermittedUsers \Rightarrow PermissionDenied$
\end{itemize}

\noindent RemoveValueAsync(pathString):
\begin{itemize}
\item transition: $DBreference.Child(pathString) := \text{null}$
\item output: $out := DBreference.HasChild(pathString)$
\item exception: $exc := NoInternet \Rightarrow NetworkError\ | \ TokenExpired \Rightarrow ExpiredToken\ | \\ User.email \notin Admins \Rightarrow PermissionDenied$
\end{itemize}

\noindent SetValueAsync(pathString, value):
\begin{itemize}
\item transition: $DBreference.Child(pathString) := value$
\item output: $out := DBreference.Child(pathString) = value$
\item exception: $exc := NoInternet \Rightarrow NetworkError\ | \ TokenExpired \Rightarrow ExpiredToken\ | \\ User.email \notin Admins \Rightarrow PermissionDenied$
\end{itemize}

\noindent GetValueAsync(pathString):
\begin{itemize}
\item transition: none
\item output: $out :=$ Snapshot of $DBreference.Child(pathString)$
\item exception: $exc := NoInternet \Rightarrow NetworkError\ | \ TokenExpired \Rightarrow ExpiredToken\ | \\ User.email \notin PermittedUsers \Rightarrow PermissionDenied$
\end{itemize}

\noindent GoOffline():
\begin{itemize}
\item transition: Manually disconnect the FirebaseDatabase client from the server and disable automatic reconnection.
\item output: none
\item exception: $exc := NoInternet \Rightarrow NetworkError\ | \ TokenExpired \Rightarrow ExpiredToken\ | \\ User.email \notin Admins \Rightarrow PermissionDenied$
\end{itemize}

\noindent GoOnline():
\begin{itemize}
\item transition: Manually reestablish a connection to the FirebaseDatabase server and enable automatic reconnection.
\item output: none
\item exception: $exc := NoInternet \Rightarrow NetworkError\ | \ TokenExpired \Rightarrow ExpiredToken\ | \\ User.email \notin Admins \Rightarrow PermissionDenied$
\end{itemize}

\subsubsection{Local Functions}

None

\newpage

\section{MIS of Server Module} \label{mServer}

\subsection{Module}

RTCServer

\subsection{Uses}

\subsection{Syntax}

\subsubsection{Exported Constants}

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{2cm} p{4cm} p{4cm} p{2cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
SendMessage & User, String & Task & - \\
SendLocation & Group, Double, Double & Task & - \\

\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}

\subsubsection{Environment Variables}

\subsubsection{Assumptions}

User identifiers are unique.

\subsubsection{Access Routine Semantics}

\noindent SendMessage(recipient, msg):
\begin{itemize}
\item transition: none
\item output: $out :=$ Task; $out$.IsCompleted $:= True$
\item exception: none
\end{itemize}

\noindent SendLocation(friendGroup, lat, lon):
\begin{itemize}
\item transition: none
\item output: $out :=$ Task; $out$.IsCompleted $:= True$
\item exception: none
\end{itemize}

\subsubsection{Local Functions}

None

\newpage

\section{MIS of AR Camera} \label{mARCamera}

\subsection{Module}

AR Camera

\subsection{Uses}

\subsection{Syntax}

\subsubsection{Exported Constants}

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{2cm} p{4cm} p{4cm} p{2cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
DetectTarget & - & - & - \\

\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}

\subsubsection{Environment Variables}

\begin{itemize}
\item cameraFeed: 2D array of pixels
\item sceneCamera: Camera
\item imageTargets: list of Target
\item scanTargets: list of Target
\end{itemize}


\subsubsection{Assumptions}

\subsubsection{Access Routine Semantics}

\noindent DetectTarget():
\begin{itemize}
\item transition: Implicitly invokes the AR Interface when a valid target is detected.
\item output: none
\item exception: none
\end{itemize}

\subsubsection{Local Functions}

None

\newpage

\section{MIS of AR Interface} \label{mARInterface}

\subsection{Module}

AR Interface

\subsection{Uses}

\subsection{Syntax}

\subsubsection{Exported Constants}

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{2cm} p{4cm} p{4cm} p{2cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
HandleInput & - & - & - \\
Display & - & - & - \\

\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}

\subsubsection{Environment Variables}

\subsubsection{Assumptions}

\subsubsection{Access Routine Semantics}

\noindent HandleInput():
\begin{itemize}
\item transition: none
\item output: none
\item exception: none
\end{itemize}

\noindent Display():
\begin{itemize}
\item transition: none
\item output: none
\item exception: none
\end{itemize}

\subsubsection{Local Functions}

None

\newpage

\section{MIS of MapBox} \label{mMap}

\subsection{Module}

MapBox

\subsection{Uses}

\subsection{Syntax}

\subsubsection{Exported Constants}

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{2cm} p{4cm} p{4cm} p{2cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
Display & - & - & - \\

\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}

\subsubsection{Environment Variables}

\begin{itemize}
\item APIKey: String
\end{itemize}

\subsubsection{Assumptions}

\subsubsection{Access Routine Semantics}

\noindent Display():
\begin{itemize}
\item transition: none
\item output: none
\item exception: none
\end{itemize}

\subsubsection{Local Functions}

None

\newpage

\section{MIS of Map Interface} \label{mMapInterface}

\subsection{Module}

Map Interface

\subsection{Uses}

\subsection{Syntax}

\subsubsection{Exported Constants}

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{2cm} p{4cm} p{4cm} p{2cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
HandleInput & - & - & - \\

\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}

\begin{itemize}
\item building: list of BuildingLocation
%\item userMarkers: list of GameObject
\end{itemize}

\subsubsection{Environment Variables}
\begin{itemize}
\item camera: Camera
\end{itemize}
  

\subsubsection{Assumptions}

\subsubsection{Access Routine Semantics}

\noindent HandleInput():
\begin{itemize}
\item transition: Opens user interface when a building marker is tapped
\item output: none
\item exception: none
\end{itemize}

\subsubsection{Local Functions}

None

\newpage

\section{MIS of Friend Chat} \label{mFC}

\subsection{Module}

Friend Chat

\subsection{Uses}

\subsection{Syntax}

\subsubsection{Exported Constants}

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{2cm} p{4cm} p{4cm} p{2cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
StartConnection & String, String & - & - \\
SendMessage & User, String & - & - \\
ReceiveMessage & User, String & - & - \\

\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}

\begin{itemize}
\item connection: HubConnection
\item onMessageReceived: Action
\end{itemize}

\subsubsection{Environment Variables}

\subsubsection{Assumptions}

\subsubsection{Access Routine Semantics}

\noindent StartConnection(url, handler):
\begin{itemize}
\item transition: Creates a new HubConnection and stores it in connection. Connects the given handler to the server endpoint.
\item output: none
\item exception: none
\end{itemize}

\noindent SendMessage(recipient, message):
\begin{itemize}
\item transition: Sends a message to the recipient through the server hub connection.
\item output: none
\item exception: none
\end{itemize}

\noindent ReceiveMessage(sender, message):
\begin{itemize}
\item transition: Receives a message from the server hub connection. The sender's id is received as well.
\item output: none
\item exception: none
\end{itemize}

\subsubsection{Local Functions}

None

\newpage

\section{Appendix} \label{Appendix}
\subsection{Database Tables}

\quad \textbf{User}
\begin{table}[H]
	\begin{tabular}{|p{0.25\textwidth}|p{0.25\textwidth}|p{0.40\textwidth}|}
		\hline
		\textbf{Column Name} & \textbf{Type}  & \textbf{Description}                  \\
		\hline
		email                   & String                & ID of a user                        \\
		\hline
		nickName           & (Optional) String                & Nickname/display name of a user      \\
		\hline
		photoUri           & (Optional) Uri                & Visual Avatar       \\
		\hline
		program            & (Optional) String                & Study field                \\
		\hline
		level             & (Optional) int                & Level of program                 \\
		\hline
		friends          &  (Optional) $<$User$>$                & List of friends \\
		\hline
		friendRequests          &  (Optional) $<$User$>$                & List of requesters              \\
		\hline
		lectures                & (Optional) $<$Lecture$>$                & List of pinned lecture                     \\
		\hline
		events                & (Optional) $<$Event$>$                & List of pinned event                     \\			
		\hline
\end{tabular}
\end{table}

\textbf{Lecture}
\begin{table}[H]
	\begin{tabular}{|p{0.25\textwidth}|p{0.25\textwidth}|p{0.40\textwidth}|}
		\hline
		\textbf{Column Name} & \textbf{Type}  & \textbf{Description}                  \\
		\hline
		code                   & String                & ID of a course, course code\\
		\hline
		name           & (Optional) String     & formal name of a course      \\
		\hline
		instructor           & (Optional) String      & name of the instructor       \\
		\hline
		time            & (Optional) String                & Includes start and end time in a weekly schedule  \\
		\hline
		location             & (Optional) String                & Building and room                 \\
		\hline
\end{tabular}
\end{table}

\textbf{Event}
\begin{table}[H]
	\begin{tabular}{|p{0.25\textwidth}|p{0.25\textwidth}|p{0.40\textwidth}|}
		\hline
		\textbf{Column Name} & \textbf{Type}  & \textbf{Description}                  \\
		\hline
		name                   & String                & ID of an event\\
		\hline
		description           & (Optional) String     & event description \\
		\hline
		organizer           & (Optional) String      & organizer of the event       \\
		\hline
		startTime            & (Optional) DateTime               & when it starts  \\
		\hline
		duration            & (Optional) int               & how long is the event (in minutes)  \\
		\hline
		location             & (Optional) String                & Building and room                 \\
		\hline
		isPublic             & $\mathbb{B}$                & If it is a public event                \\
		\hline
\end{tabular}
\end{table}
\newpage
\bibliographystyle {plainnat}
\bibliography{../../../refs/References}
\end{document}